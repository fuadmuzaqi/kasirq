<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Kasir Cloud Pro</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"/>

<style>
/* ================== APP STYLE ================== */
:root{
  --bg:#020617; --card:#0f172a; --primary:#2563eb;
  --text:#e5e7eb; --muted:#94a3b8;
}
*{box-sizing:border-box;font-family:Inter,system-ui,sans-serif}
body{margin:0;background:var(--bg);color:var(--text)}
.app{max-width:500px;margin:auto;padding:12px;padding-bottom:110px}
header{position:sticky;top:0;background:#020617;padding:12px;font-weight:800}
.card{background:var(--card);border-radius:12px;padding:14px;margin-bottom:12px}
input,button{width:100%;height:44px;border-radius:10px;border:none}
input{padding:0 12px}
button{font-weight:700}
.btn-primary{background:var(--primary);color:#fff}

/* ================== PRINT STRUK ================== */
#printArea{
  position:fixed;
  top:0; left:0;
  width:100%;
  background:#fff;
  color:#000;
  visibility:hidden;
}

#printArea pre{
  font-family: "Courier New", monospace;
  font-size:11px;
  line-height:1.35;
  white-space:pre-wrap;
}

/* PRINT MODE */
@media print{
  @page{
    size:58mm auto;
    margin:0;
  }

  body{
    background:#fff!important;
  }

  body *{
    visibility:hidden!important;
  }

  #printArea,
  #printArea *{
    visibility:visible!important;
  }

  #printArea{
    position:absolute;
    inset:0;
    padding:6mm;
  }
}
</style>
</head>

<body>

<div class="app">
  <header>KASIR</header>

  <div class="card">
    <button class="btn-primary" onclick="demoPrint()">TEST CETAK STRUK</button>
  </div>
</div>

<!-- ================== PRINT AREA ================== -->
<div id="printArea">
  <pre id="printContent"></pre>
</div>

<script>
/* ================== UTIL ================== */
const rp = v => "Rp " + (v||0).toLocaleString("id-ID");

/* ================== PRINT STRUK (MOBILE SAFE) ================== */
function printStruk(trx){
  const W = 32;
  const line = "-".repeat(W);

  let t  = "";
  t += center("TOKO CONTOH", W) + "\n";
  t += center("Jl. Contoh No.1", W) + "\n";
  t += center("WA 08123456789", W) + "\n";
  t += line + "\n";

  t += `No : ${trx.id}\n`;
  t += `Tgl: ${trx.date}\n`;
  t += line + "\n";

  trx.items.forEach(i=>{
    t += i.name.substring(0,W) + "\n";
    t += `${i.qty} x ${i.price.toLocaleString()}`
       .padEnd(W- i.subtotal.toLocaleString().length)
       + i.subtotal.toLocaleString() + "\n";
  });

  t += line + "\n";
  t += right("TOTAL", rp(trx.total), W) + "\n";
  t += right("BAYAR", rp(trx.bayar), W) + "\n";
  t += right("KEMBALI", rp(trx.kembali), W) + "\n";
  t += line + "\n";
  t += center("TERIMA KASIH", W) + "\n";
  t += center("Barang tidak dapat ditukar", W);

  const area = document.getElementById("printArea");
  const pre  = document.getElementById("printContent");

  pre.textContent = t;
  area.style.visibility = "visible";

  setTimeout(()=>window.print(),300);

  window.onafterprint = ()=>{
    area.style.visibility="hidden";
    pre.textContent="";
  };
}

/* ================== FORMAT ================== */
function center(txt,w){
  const p = Math.max(0,Math.floor((w-txt.length)/2));
  return " ".repeat(p)+txt;
}
function right(l,r,w){
  return l + " ".repeat(Math.max(1,w-l.length-r.length)) + r;
}

/* ================== DEMO ================== */
function demoPrint(){
  printStruk({
    id:"INV001",
    date:new Date().toLocaleString("id-ID"),
    total:25000,
    bayar:30000,
    kembali:5000,
    items:[
      {name:"Kopi Susu",qty:1,price:15000,subtotal:15000},
      {name:"Roti Bakar",qty:1,price:10000,subtotal:10000}
    ]
  });
}
</script>
</body>
</html>
